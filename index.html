<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฎุชุจุฑ OBD - ุฅุดุฑุงู: ุงูุจุงุญุซ Ammar Nasir Hussein al-mantafji</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        /* ุฌููุน ุงูุฃููุงุท ุงูุณุงุจูุฉ ุชุจูู ููุง ูู */
        /* ุณุฃุถูู ุฃููุงุท ุฅุถุงููุฉ ููุท */
        
        .api-config-section {
            background: rgba(0, 30, 80, 0.6);
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
            border: 1px solid rgba(0, 100, 255, 0.3);
            box-shadow: 0 5px 15px rgba(0, 100, 255, 0.1);
        }
        
        .api-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .api-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 100, 255, 0.3);
            border-radius: 8px;
            padding: 12px 15px;
            color: white;
            font-size: 0.95rem;
            font-family: monospace;
            transition: all 0.3s ease;
        }
        
        .api-input:focus {
            outline: none;
            border-color: #00a8ff;
            box-shadow: 0 0 20px rgba(0, 168, 255, 0.3);
        }
        
        .api-info {
            font-size: 0.85rem;
            color: #a0d2db;
            line-height: 1.5;
            margin-top: 10px;
        }
        
        .api-info a {
            color: #4bcffa;
            text-decoration: none;
        }
        
        .api-info a:hover {
            text-decoration: underline;
        }
        
        .api-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .api-connected {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid rgba(46, 204, 113, 0.3);
            color: #2ecc71;
        }
        
        .api-disconnected {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <!-- ุดุงุดุฉ ุงูุชุญููู -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="lab-spinner"></div>
        <div class="loading-text" id="loading-text">ุฌุงุฑู ุฅุนุฏุงุฏ ูุฎุชุจุฑ OBD...</div>
    </div>

    <div class="container">
        <!-- ุฑุฃุณ ุงููุฎุชุจุฑ -->
        <div class="lab-header">
            <div class="researcher-badge">
                <i class="fas fa-user-tie"></i> ุจุงุญุซ ุฑุฆูุณู
            </div>
            <div class="lab-badge">
                <i class="fas fa-flask"></i> ูุฎุชุจุฑ OBD ุชุฌุฑูุจู
            </div>
            <div class="ai-lab-badge">
                <i class="fas fa-robot"></i> ูุฏุนูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
            </div>
            <div class="system-badge">
                <i class="fas fa-atom"></i> ูุธุงู ููู ูุชูุฏู
            </div>
            
            <h1 class="research-title">ูุฎุชุจุฑ Observable Boundary Dynamics (OBD)</h1>
            <p class="lab-subtitle">ูุธุงู ูุญุงูุงุฉ ูุชูุฏู ููุจุญุซ ุงูุนููู ุงูุชุฌุฑูุจู</p>
            
            <div class="researcher-info">ุฅุดุฑุงู: ุงูุจุงุญุซ</div>
            <div class="researcher-title">Ammar Nasir Hussein al-mantafji</div>
            
            <div class="research-description">
                ูุฎุชุจุฑ OBD ูู ูุธุงู ูุญุงูุงุฉ ูุชูุฏู ูุทุจู ุฃุจุญุงุซ Observable Boundary Dynamics ุงูุชู ุชุฏุฑุณ ุงูุชูุงู ุงููุนูููุงุช 
                ูู "ุงูุฏุงุฎู" (Bulk) ุฅูู "ุงูุญุฏูุฏ" (Boundary) ูู ุงูุฃูุธูุฉ ุงูููููุบุฑุงููุฉ. ูุฐุง ุงููุธุงู ูุฏูุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู 
                ูุชุญููู ุงููุชุงุฆุฌ ูููุงุฑูุชูุง ุจุงูุจุญุซ ุงูุฃูุงุฏููู ุงูุฃุตูู.
            </div>
        </div>

        <!-- ูุธุงู ุงููุฎุชุจุฑ ุงูุฑุฆูุณู -->
        <div class="lab-system">
            <!-- ููุญุฉ ุงูุชุญูู -->
            <div class="lab-control-panel">
                <h2 class="section-title"><i class="fas fa-sliders-h"></i> ููุญุฉ ุชุญูู ุงููุฎุชุจุฑ</h2>
                
                <!-- ูุณู ุฅุนุฏุงุฏุงุช API ุงูุฌุฏูุฏ -->
                <div class="api-config-section">
                    <h3 class="subsection-title"><i class="fas fa-key"></i> ุฅุนุฏุงุฏุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู</h3>
                    
                    <div class="api-input-group">
                        <input type="password" id="api-key-input" class="api-input" 
                               placeholder="ุฃุฏุฎู ููุชุงุญ OpenRouter API ุงูุฎุงุต ุจู"
                               value="">
                        <button class="control-btn success" onclick="saveAPIKey()" style="padding: 12px 20px; font-size: 0.9rem;">
                            <i class="fas fa-save"></i> ุญูุธ
                        </button>
                    </div>
                    
                    <div id="api-status" class="api-status api-disconnected">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>ุบูุฑ ูุชุตู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</span>
                    </div>
                    
                    <div class="api-info">
                        <i class="fas fa-info-circle"></i>
                        ููุญุตูู ุนูู ููุชุงุญ API ูุฌุงูู:
                        <br>
                        1. ุชูุถู ุฅูู <a href="https://openrouter.ai" target="_blank">OpenRouter.ai</a>
                        <br>
                        2. ุณุฌู ุญุณุงุจ ุฌุฏูุฏ (ูุฌุงูู)
                        <br>
                        3. ุงุญุตู ุนูู ููุชุงุญ API ูู ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช
                        <br>
                        4. ุฃุฏุฎู ุงูููุชุงุญ ููุง ูุชูุนูู ุงูุชุญููู ุงูุฐูู
                    </div>
                </div>
                
                <!-- ูููุฐุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู -->
                <div class="parameter-group" style="margin-top: 20px;">
                    <label class="param-label">ูููุฐุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู:</label>
                    <select id="ai-model-select" class="api-input" style="width: 100%; padding: 10px;">
                        <option value="openai/gpt-3.5-turbo">GPT-3.5 Turbo (ุณุฑูุน ูููุฎูุถ ุงูุชูููุฉ)</option>
                        <option value="openai/gpt-4">GPT-4 (ุฃูุซุฑ ุฏูุฉ)</option>
                        <option value="anthropic/claude-3-haiku">Claude 3 Haiku</option>
                        <option value="google/gemini-pro">Gemini Pro</option>
                        <option value="meta-llama/llama-3-70b-instruct">Llama 3 70B</option>
                    </select>
                </div>

                <h3 class="subsection-title"><i class="fas fa-microscope"></i> ูุนุฏุงุช ุงููุฎุชุจุฑ</h3>
                <div class="lab-equipment">
                    <div class="equipment-card" id="laser-equipment">
                        <div class="equipment-icon">
                            <i class="fas fa-satellite-dish"></i>
                        </div>
                        <div class="equipment-name">ูุตุฏุฑ ููุฒุฑ ูุชูุงุณู</div>
                        <div class="equipment-status" id="laser-status">๐ข ุฌุงูุฒ</div>
                    </div>
                    
                    <div class="equipment-card" id="scrambler-equipment">
                        <div class="equipment-icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <div class="equipment-name">ูุณุท ุงูุชุดุชูุช (Bulk)</div>
                        <div class="equipment-status" id="scrambler-status">๐ข ูุดุท</div>
                    </div>
                    
                    <div class="equipment-card" id="sensor-equipment">
                        <div class="equipment-icon">
                            <i class="fas fa-satellite"></i>
                        </div>
                        <div class="equipment-name">ูุณุชุดุนุฑ ุงูุญุฏูุฏ</div>
                        <div class="equipment-status" id="sensor-status">๐ข ูุนูู</div>
                    </div>
                    
                    <div class="equipment-card" id="ai-processor">
                        <div class="equipment-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="equipment-name">ูุนุงูุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู</div>
                        <div class="equipment-status" id="ai-status">๐ด ุบูุฑ ูุชุตู</div>
                    </div>
                </div>

                <!-- ุฅุฌุฑุงุกุงุช ุงูุชุฌุฑุจุฉ -->
                <h3 class="subsection-title"><i class="fas fa-vial"></i> ุฅุฌุฑุงุกุงุช ุงูุชุฌุฑุจุฉ</h3>
                <div class="experiment-procedures">
                    <div class="procedure-step" id="step-1">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">ุฅุนุฏุงุฏ ุงูุนููุฉ</div>
                            <div class="step-description">ุชุญุถูุฑ ูุณุท ุงูุชุดุชูุช ุนุงูู ุงูุฅูุชุฑูุจูุง</div>
                        </div>
                    </div>
                    
                    <div class="procedure-step" id="step-2">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">ุญูู ุงูุจูุงูุงุช</div>
                            <div class="step-description">ุชุฑููุฒ ุงููุนูููุงุช ูู ุงูุญุงูุฉ ุงููููููุฉ ุงูุฃูููุฉ</div>
                        </div>
                    </div>
                    
                    <div class="procedure-step" id="step-3">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">ุงูุชุดุชูุช ุงููุญุฏูู</div>
                            <div class="step-description">ุชูุนูู ูุตูููุฉ ุงูุชุดุชูุช U(t)</div>
                        </div>
                    </div>
                    
                    <div class="procedure-step" id="step-4">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">ุงูุงุณุชุดุนุงุฑ ูุงูุชุญููู</div>
                            <div class="step-description">ูุฑุงุกุฉ ุฃููุงุท ุงูุชุฏุงุฎู ุนูู ุงูุญุฏูุฏ</div>
                        </div>
                    </div>
                </div>

                <!-- ูุนุงููุงุช ุงูุชุฌุฑุจุฉ -->
                <h3 class="subsection-title"><i class="fas fa-tachometer-alt"></i> ูุนุงููุงุช ุงูุชุฌุฑุจุฉ</h3>
                <div class="parameter-controls">
                    <div class="parameter-group">
                        <label class="param-label">ุดุฏุฉ ุงูููุฒุฑ (mW)</label>
                        <div class="slider-container">
                            <input type="range" id="laser-power" min="1" max="100" value="50">
                            <span class="param-value" id="laser-power-value">50</span>
                        </div>
                    </div>
                    
                    <div class="parameter-group">
                        <label class="param-label">ุฅูุชุฑูุจูุง ุงููุณุท</label>
                        <div class="slider-container">
                            <input type="range" id="medium-entropy" min="1" max="100" value="75">
                            <span class="param-value" id="entropy-value">75</span>
                        </div>
                    </div>
                    
                    <div class="parameter-group">
                        <label class="param-label">ุฒูู ุงูุชุดุชูุช (ms)</label>
                        <div class="slider-container">
                            <input type="range" id="scramble-time" min="1" max="1000" value="500">
                            <span class="param-value" id="time-value">500</span>
                        </div>
                    </div>
                    
                    <div class="parameter-group">
                        <label class="param-label">ุถูุถุงุก ุงููุญูุท (dB)</label>
                        <div class="slider-container">
                            <input type="range" id="noise-level" min="0" max="100" value="25">
                            <span class="param-value" id="noise-value">25</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ุงูุชุตูุฑ ุงููุฑุฆู ูุงููุชุงุฆุฌ -->
            <div class="lab-visualization">
                <h2 class="section-title"><i class="fas fa-chart-line"></i> ุงูุชุตูุฑ ุงูุชุฌุฑูุจู</h2>
                
                <!-- ุงูุชุตูุฑ ุงููุฑุฆู ูููุฎุชุจุฑ -->
                <div class="lab-visual">
                    <div class="laser-beam" id="laser-beam"></div>
                    <div class="bulk-medium" id="bulk-medium"></div>
                    <div class="boundary-sensor" id="boundary-sensor">
                        <i class="fas fa-wifi"></i> ูุณุชุดุนุฑ ุงูุญุฏูุฏ
                    </div>
                    <div class="data-stream" id="data-stream">
                        <div>๐ ุชูุงุฑ ุงูุจูุงูุงุช ุงูุญู:</div>
                        <div id="stream-content">ุฌุงุฑู ุงูุชุธุงุฑ ุงูุจูุงูุงุช...</div>
                    </div>
                </div>

                <!-- ูุชุงุฆุฌ ุงูุชุฌุฑุจุฉ -->
                <h3 class="subsection-title"><i class="fas fa-clipboard-list"></i> ููุงุณุงุช ุงููุชุงุฆุฌ</h3>
                <div class="experiment-results">
                    <div class="result-metric">
                        <div class="metric-name">ุฑุคูุฉ ุงูุฏุงุฎู</div>
                        <div class="metric-value" id="bulk-visibility">4.2</div>
                        <div class="metric-unit">%</div>
                    </div>
                    
                    <div class="result-metric">
                        <div class="metric-name">ุงุฑุชุจุงุท ุงูุญุฏูุฏ</div>
                        <div class="metric-value" id="boundary-correlation">0.98</div>
                        <div class="metric-unit">ูุนุงูู</div>
                    </div>
                    
                    <div class="result-metric">
                        <div class="metric-name">ุฏูุฉ ุงูุงุณุชุฑุฏุงุฏ</div>
                        <div class="metric-value" id="recovery-fidelity">99.1</div>
                        <div class="metric-unit">%</div>
                    </div>
                    
                    <div class="result-metric">
                        <div class="metric-name">ุฃุณ ููุงุจุงููู</div>
                        <div class="metric-value" id="lyapunov-exponent">0.42</div>
                        <div class="metric-unit">ฮป<sub>L</sub></div>
                    </div>
                </div>

                <!-- ุฃุฒุฑุงุฑ ุงูุชุญูู -->
                <div class="control-buttons">
                    <button class="control-btn success" onclick="runExperiment()">
                        <i class="fas fa-play-circle"></i> ุชุดุบูู ุงูุชุฌุฑุจุฉ
                    </button>
                    
                    <button class="control-btn" onclick="analyzeResults()">
                        <i class="fas fa-brain"></i> ุชุญููู ุงููุชุงุฆุฌ
                    </button>
                    
                    <button class="control-btn warning" onclick="generateReport()">
                        <i class="fas fa-file-alt"></i> ุชูุฑูุฑ ููุตู
                    </button>
                    
                    <button class="control-btn secondary" onclick="resetExperiment()">
                        <i class="fas fa-redo"></i> ุฅุนุงุฏุฉ ุชุนููู
                    </button>
                </div>
            </div>
        </div>

        <!-- ููุญุฉ ุชุญููู ุงูุฐูุงุก ุงูุงุตุทูุงุนู -->
        <div class="ai-analysis-panel">
            <div class="ai-header">
                <i class="fas fa-robot ai-icon"></i>
                <h2 class="ai-title">ูุญูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูููุฎุชุจุฑ</h2>
            </div>
            
            <div class="analysis-content" id="ai-analysis-content">
                <div class="analysis-message message-ai">
                    <div class="message-header ai-message-header">
                        <i class="fas fa-robot"></i> ูุณุงุนุฏ OBD
                    </div>
                    <div class="message-content">
                        ูุฑุญุจุงู ุจู ูู ูุฎุชุจุฑ OBD ุงูุชุฌุฑูุจู! ุฃูุง ูุณุงุนุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุชุฎุตุต ูู ุชุญููู ูุชุงุฆุฌ ุชุฌุงุฑุจ Observable Boundary Dynamics.
                        <br><br>
                        ูููููู ูุณุงุนุฏุชู ูู:
                        <br>โข ุชุญููู ุงูููุงุณุงุช ุงูุชุฌุฑูุจูุฉ
                        <br>โข ุชูุณูุฑ ุงููุชุงุฆุฌ ููู ุงููููุฐุฌ ุงููุธุฑู
                        <br>โข ุงูุชุฑุงุญ ุชุญุณููุงุช ููุชุฌุฑุจุฉ
                        <br>โข ูุชุงุจุฉ ุชูุงุฑูุฑ ุนูููุฉ ููุตูุฉ
                        <br><br>
                        โ๏ธ <strong>ููุจุฏุก:</strong> ุฃุฏุฎู ููุชุงุญ OpenRouter API ูู ูุณู ุงูุฅุนุฏุงุฏุงุช ุฃุนูุงู.
                    </div>
                </div>
            </div>

            <!-- ุงูุชุฑุงุญุงุช ุณุฑูุนุฉ -->
            <div class="ai-suggestions">
                <div class="suggestion-btn" onclick="askAI('ุญูู ูุชุงุฆุฌ ุงูุชุฌุฑุจุฉ ุงูุญุงููุฉ ููู ุงููููุฐุฌ ุงููุธุฑู OBD')">
                    ๐ ุชุญููู ุงููุชุงุฆุฌ ุงูุญุงููุฉ
                </div>
                <div class="suggestion-btn" onclick="askAI('ูุง ูู ุงูุนูุงูู ุงููุคุซุฑุฉ ุนูู ุฃุณ ููุงุจุงููู ูู ูุฐู ุงูุชุฌุฑุจุฉุ')">
                    ๐ฌ ุชูุณูุฑ ุฃุณ ููุงุจุงููู
                </div>
                <div class="suggestion-btn" onclick="askAI('ุงูุชุฑุญ ุชุญุณููุงุช ูุฒูุงุฏุฉ ุฏูุฉ ุงูุงุณุชุฑุฏุงุฏ')">
                    โก ุงูุชุฑุงุญ ุชุญุณููุงุช
                </div>
                <div class="suggestion-btn" onclick="askAI('ูุงุฑู ุจูู ูุฐู ุงููุชุงุฆุฌ ูุงููุชุงุฆุฌ ูู ุงูุจุญุซ ุงูุฃุตูู')">
                    ๐ ููุงุฑูุฉ ูุน ุงูุจุญุซ
                </div>
            </div>
        </div>

        <!-- ุชุฐููู ุงูุตูุญุฉ -->
        <div class="footer">
            <div class="researcher-signature">
                <div class="signature-text">ุชู ุชุทููุฑ ูุฐุง ุงููุธุงู ุงูุจุญุซู ุงููุชูุฏู ุชุญุช ุฅุดุฑุงู:</div>
                <div class="researcher-name-footer">ุงูุจุงุญุซ Ammar Nasir Hussein al-mantafji</div>
            </div>
            
            <p style="margin-top: 30px;">ยฉ 2026 ูุฎุชุจุฑ OBD ุงูุชุฌุฑูุจู ุงููุชูุฏู - ูุธุงู ุจุญุซู ููู ููููุบุฑุงูู</p>
            <p style="margin-top: 15px; color: #4bcffa;">
                <i class="fas fa-exclamation-circle"></i>
                ูุฐุง ุงููุธุงู ูุญุงูู ุงูุชุฌุงุฑุจ ุงูุญููููุฉ ูู ูุฎุชุจุฑ OBD ูุน ุชุญููู ุฐูู ูููุชุงุฆุฌ ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
            </p>
            <p style="margin-top: 10px; font-size: 0.9rem; color: #7bd5ff;">
                ุงููุฑุฌุน ุงูุจุญุซู: OBD_New29_1_2026.pdf - ุจุญุซ Observable Boundary Dynamics
            </p>
        </div>
    </div>

    <script>
        // ูุชุบูุฑุงุช ุงููุธุงู
        let currentExperiment = null;
        let experimentResults = null;
        let apiKey = localStorage.getItem('obd_lab_api_key') || '';
        let aiModel = 'openai/gpt-3.5-turbo';
        let chatHistory = [];

        // ุนูุงุตุฑ DOM
        const loadingOverlay = document.getElementById('loading-overlay');
        const loadingText = document.getElementById('loading-text');
        const aiAnalysisContent = document.getElementById('ai-analysis-content');
        const dataStreamContent = document.getElementById('stream-content');
        const apiKeyInput = document.getElementById('api-key-input');
        const apiStatusElement = document.getElementById('api-status');
        const aiModelSelect = document.getElementById('ai-model-select');
        const aiStatusElement = document.getElementById('ai-status');

        // ุชููุฆุฉ ุงููุธุงู
        document.addEventListener('DOMContentLoaded', function() {
            showLoading('ุฌุงุฑู ุฅุนุฏุงุฏ ูุฎุชุจุฑ OBD...');
            
            // ุชููุฆุฉ API Key
            if (apiKey) {
                apiKeyInput.value = 'โขโขโขโขโขโขโขโขโขโขโขโขโขโขโขโข';
                updateAPIStatus(true);
                updateEquipmentStatus('ai-processor', '๐ข ูุชุตู');
            } else {
                updateAPIStatus(false);
                updateEquipmentStatus('ai-processor', '๐ด ุบูุฑ ูุชุตู');
            }
            
            // ุชููุฆุฉ ูููุฐุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู
            aiModelSelect.value = aiModel;
            aiModelSelect.addEventListener('change', function() {
                aiModel = this.value;
                localStorage.setItem('obd_ai_model', aiModel);
                showNotification(`ุชู ุชุบููุฑ ุงููููุฐุฌ ุฅูู: ${this.selectedOptions[0].text}`);
            });
            
            // ุชุญููู ุงููููุฐุฌ ุงููุญููุธ
            const savedModel = localStorage.getItem('obd_ai_model');
            if (savedModel) {
                aiModel = savedModel;
                aiModelSelect.value = savedModel;
            }
            
            // ุชุดุบูู ุงูุชููุฆุฉ ุงููุฑุฆูุฉ
            initializeVisualization();
            
            // ุจุฏุก ูุญุงูุงุฉ ุฃูููุฉ
            setTimeout(() => {
                hideLoading();
                runInitialDemo();
            }, 2000);
        });

        // ุชุญุฏูุซ ุญุงูุฉ API
        function updateAPIStatus(isConnected) {
            if (isConnected) {
                apiStatusElement.className = 'api-status api-connected';
                apiStatusElement.innerHTML = '<i class="fas fa-check-circle"></i> <span>ูุชุตู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</span>';
                updateEquipmentStatus('ai-processor', '๐ข ูุชุตู');
            } else {
                apiStatusElement.className = 'api-status api-disconnected';
                apiStatusElement.innerHTML = '<i class="fas fa-exclamation-circle"></i> <span>ุบูุฑ ูุชุตู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู</span>';
                updateEquipmentStatus('ai-processor', '๐ด ุบูุฑ ูุชุตู');
            }
        }

        // ุญูุธ ููุชุงุญ API
        function saveAPIKey() {
            const key = apiKeyInput.value.trim();
            
            if (!key) {
                showNotification('ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุชุงุญ API');
                return;
            }
            
            // ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฏุฎู ููุชุงุญุงู ุฌุฏูุฏุงู (ูููุณ ุงูููุงุท)
            if (key !== 'โขโขโขโขโขโขโขโขโขโขโขโขโขโขโขโข') {
                apiKey = key;
                localStorage.setItem('obd_lab_api_key', key);
                
                // ุฅุฎูุงุก ุงูููุชุงุญ
                apiKeyInput.value = 'โขโขโขโขโขโขโขโขโขโขโขโขโขโขโขโข';
                apiKeyInput.type = 'password';
                
                updateAPIStatus(true);
                showNotification('ุชู ุญูุธ ููุชุงุญ API ุจูุฌุงุญ');
                
                // ุฅุถุงูุฉ ุฑุณุงูุฉ ุชุฑุญูุจูุฉ
                addAIMessage('ุชู ุงูุงุชุตุงู ุจูุฌุงุญ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู! ูููููู ุงูุขู ูุณุงุนุฏุชู ูู ุชุญููู ูุชุงุฆุฌ ุงูุชุฌุงุฑุจ.');
                
                // ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
                testAPIConnection();
            } else {
                showNotification('ุงูููุชุงุญ ูุญููุธ ุจุงููุนู');
            }
        }

        // ุงุฎุชุจุงุฑ ุงุชุตุงู API
        async function testAPIConnection() {
            try {
                const response = await axios.post(
                    'https://openrouter.ai/api/v1/chat/completions',
                    {
                        model: aiModel,
                        messages: [
                            {
                                role: "system",
                                content: "ุฃูุช ูุณุงุนุฏ ูุฎุชุจุฑ OBD. ุฃุฌุจ ุจูููุฉ 'ูุชุตู' ููุท."
                            },
                            {
                                role: "user",
                                content: "ูู ุฃูุช ูุชุตูุ"
                            }
                        ],
                        max_tokens: 10
                    },
                    {
                        headers: {
                            'Authorization': `Bearer ${apiKey}`,
                            'Content-Type': 'application/json'
                        }
                    }
                );
                
                if (response.data.choices[0].message.content.includes('ูุชุตู')) {
                    showNotification('โ ุชู ุงูุชุญูู ูู ุงุชุตุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู');
                }
            } catch (error) {
                console.warn('ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ูุดู:', error.message);
            }
        }

        // ุฅุธูุงุฑ ุดุงุดุฉ ุงูุชุญููู
        function showLoading(text) {
            loadingText.textContent = text;
            loadingOverlay.classList.add('active');
        }

        // ุฅุฎูุงุก ุดุงุดุฉ ุงูุชุญููู
        function hideLoading() {
            loadingOverlay.classList.remove('active');
        }

        // ุชููุฆุฉ ุงูุชุตูุฑ ุงููุฑุฆู
        function initializeVisualization() {
            updateEquipmentStatus('laser-equipment', '๐ข ุฌุงูุฒ');
            updateEquipmentStatus('scrambler-equipment', '๐ข ูุดุท');
            updateEquipmentStatus('sensor-equipment', '๐ข ูุนูู');
            
            // ุชุญุฏูุซ ุญุงูุฉ ุงูุฎุทูุงุช
            updateExperimentStep(1);
        }

        // ุชุญุฏูุซ ุญุงูุฉ ุงููุนุฏุงุช
        function updateEquipmentStatus(equipmentId, status) {
            const equipment = document.getElementById(equipmentId);
            if (equipment) {
                const statusElement = equipment.querySelector('.equipment-status');
                if (statusElement) {
                    statusElement.textContent = status;
                    
                    if (status.includes('๐ข')) {
                        statusElement.classList.remove('offline');
                    } else {
                        statusElement.classList.add('offline');
                    }
                }
            }
        }

        // ุชุญุฏูุซ ุฎุทูุฉ ุงูุชุฌุฑุจุฉ
        function updateExperimentStep(stepNumber) {
            // ุฅุนุงุฏุฉ ุชุนููู ุฌููุน ุงูุฎุทูุงุช
            for (let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step-${i}`);
                if (step) {
                    step.style.opacity = '0.6';
                    step.style.borderColor = 'rgba(0, 100, 255, 0.1)';
                }
            }
            
            // ุชูููุฒ ุงูุฎุทูุฉ ุงูุญุงููุฉ
            const currentStep = document.getElementById(`step-${stepNumber}`);
            if (currentStep) {
                currentStep.style.opacity = '1';
                currentStep.style.borderColor = 'rgba(0, 100, 255, 0.3)';
            }
        }

        // ุชุญุฏูุซ ุงูุชุตูุฑ ุงููุฑุฆู
        function updateVisualization() {
            const laserPower = parseInt(document.getElementById('laser-power').value);
            const entropy = parseInt(document.getElementById('medium-entropy').value);
            const noise = parseInt(document.getElementById('noise-level').value);
            
            // ุชุญุฏูุซ ุดุนุงุน ุงูููุฒุฑ
            const laserBeam = document.getElementById('laser-beam');
            laserBeam.style.width = `${100 + laserPower * 2}px`;
            laserBeam.style.opacity = laserPower / 100;
            
            // ุชุญุฏูุซ ูุณุท ุงูุชุดุชูุช
            const bulkMedium = document.getElementById('bulk-medium');
            const scrambleIntensity = entropy / 100;
            bulkMedium.style.background = `
                radial-gradient(circle, 
                    rgba(0, ${100 + entropy}, 255, ${0.1 + scrambleIntensity * 0.2}),
                    rgba(0, ${50 + entropy * 0.5}, 150, ${0.2 + scrambleIntensity * 0.3}),
                    rgba(0, 20, 60, ${0.3 + scrambleIntensity * 0.4})
                )
            `;
            
            // ุชุญุฏูุซ ุชูุงุฑ ุงูุจูุงูุงุช
            updateDataStream();
        }

        // ุชุญุฏูุซ ุชูุงุฑ ุงูุจูุงูุงุช
        function updateDataStream() {
            const time = new Date();
            const entropy = parseInt(document.getElementById('medium-entropy').value);
            const noise = parseInt(document.getElementById('noise-level').value);
            
            const dataPoints = [
                `๐ ${time.toLocaleTimeString('ar-SA')}`,
                `๐ ุฅูุชุฑูุจูุง: ${entropy}%`,
                `๐ ุถูุถุงุก: ${noise}dB`,
                `๐ก๏ธ ุญุฑุงุฑุฉ: ${(25 + Math.random() * 5).toFixed(1)}ยฐC`,
                `โก ุทุงูุฉ: ${(Math.random() * 100).toFixed(1)}mW`
            ];
            
            const randomData = dataPoints[Math.floor(Math.random() * dataPoints.length)];
            dataStreamContent.textContent = randomData;
        }

        // ุชุดุบูู ุชุฌุฑุจุฉ ุฃูููุฉ ุชูุถูุญูุฉ
        function runInitialDemo() {
            showLoading('ุฌุงุฑู ุชุดุบูู ุงูุชุฌุฑุจุฉ ุงูุชูุถูุญูุฉ...');
            
            setTimeout(() => {
                // ูุญุงูุงุฉ ุฎุทูุงุช ุงูุชุฌุฑุจุฉ
                simulateExperimentSteps();
                
                // ุญุณุงุจ ุงููุชุงุฆุฌ
                calculateResults();
                
                hideLoading();
            }, 1500);
        }

        // ูุญุงูุงุฉ ุฎุทูุงุช ุงูุชุฌุฑุจุฉ
        function simulateExperimentSteps() {
            // ุงูุฎุทูุฉ 1: ุฅุนุฏุงุฏ ุงูุนููุฉ
            updateExperimentStep(1);
            showNotification('ุฌุงุฑู ุชุญุถูุฑ ูุณุท ุงูุชุดุชูุช ุนุงูู ุงูุฅูุชุฑูุจูุง...');
            
            setTimeout(() => {
                // ุงูุฎุทูุฉ 2: ุญูู ุงูุจูุงูุงุช
                updateExperimentStep(2);
                showNotification('ุฌุงุฑู ุชุฑููุฒ ุงูุจูุงูุงุช ูู ุงูุญุงูุฉ ุงููููููุฉ...');
                
                setTimeout(() => {
                    // ุงูุฎุทูุฉ 3: ุงูุชุดุชูุช ุงููุญุฏูู
                    updateExperimentStep(3);
                    showNotification('ุชูุนูู ูุตูููุฉ ุงูุชุดุชูุช U(t)...');
                    
                    setTimeout(() => {
                        // ุงูุฎุทูุฉ 4: ุงูุงุณุชุดุนุงุฑ ูุงูุชุญููู
                        updateExperimentStep(4);
                        showNotification('ูุฑุงุกุฉ ุฃููุงุท ุงูุชุฏุงุฎู ุนูู ุงูุญุฏูุฏ...');
                        
                        // ุชุดุบูู ุงูุชุฃุซูุฑุงุช ุงููุฑุฆูุฉ
                        runVisualEffects();
                        
                    }, 800);
                }, 800);
            }, 800);
        }

        // ุชุดุบูู ุงูุชุฃุซูุฑุงุช ุงููุฑุฆูุฉ
        function runVisualEffects() {
            const laserBeam = document.getElementById('laser-beam');
            const bulkMedium = document.getElementById('bulk-medium');
            const boundarySensor = document.getElementById('boundary-sensor');
            
            // ุชุฃุซูุฑ ุงูููุฒุฑ
            laserBeam.style.transform = 'scaleX(1.2)';
            laserBeam.style.boxShadow = '0 0 30px rgba(255, 0, 0, 0.8)';
            
            // ุชุฃุซูุฑ ุงูุชุดุชูุช
            bulkMedium.style.transform = 'scale(1.05)';
            bulkMedium.style.boxShadow = '0 0 40px rgba(0, 100, 255, 0.6)';
            
            // ุชุฃุซูุฑ ุงููุณุชุดุนุฑ
            boundarySensor.style.transform = 'scale(1.1)';
            boundarySensor.style.boxShadow = '0 0 30px rgba(46, 204, 113, 0.6)';
            boundarySensor.innerHTML = '<i class="fas fa-wifi fa-spin"></i> ๐ก ูุฌูุน ุงูุจูุงูุงุช...';
            
            setTimeout(() => {
                // ุฅุนุงุฏุฉ ุงูุชุฃุซูุฑุงุช
                laserBeam.style.transform = 'scaleX(1)';
                laserBeam.style.boxShadow = '0 0 20px rgba(255, 0, 0, 0.5)';
                bulkMedium.style.transform = 'scale(1)';
                bulkMedium.style.boxShadow = '0 0 20px rgba(0, 100, 255, 0.3)';
                boundarySensor.style.transform = 'scale(1)';
                boundarySensor.style.boxShadow = '0 0 20px rgba(46, 204, 113, 0.3)';
                boundarySensor.innerHTML = '<i class="fas fa-wifi"></i> โ ุงูุชูู ุงูุฌูุน';
                
            }, 2000);
        }

        // ุญุณุงุจ ุงููุชุงุฆุฌ
        function calculateResults() {
            const laserPower = parseInt(document.getElementById('laser-power').value);
            const entropy = parseInt(document.getElementById('medium-entropy').value);
            const scrambleTime = parseInt(document.getElementById('scramble-time').value);
            const noise = parseInt(document.getElementById('noise-level').value);
            
            // ุญุณุงุจ ุงููุชุงุฆุฌ ุจูุงุกู ุนูู ูุนุงุฏูุงุช ุงูุจุญุซ
            const bulkVisibility = 4.2 * Math.exp(-entropy/100 * 2) * (1 - noise/100 * 0.3);
            const boundaryCorrelation = 0.98 * Math.exp(-noise/100 * 0.8) * (1 + entropy/100 * 0.1);
            const recoveryFidelity = 99.1 * Math.exp(-noise/100 * 0.4 - entropy/100 * 0.3);
            const lyapunovExponent = 0.42 * (entropy/100) * (scrambleTime/500);
            
            // ุชุฎุฒูู ุงููุชุงุฆุฌ
            experimentResults = {
                laserPower,
                entropy,
                scrambleTime,
                noise,
                bulkVisibility,
                boundaryCorrelation,
                recoveryFidelity,
                lyapunovExponent,
                timestamp: new Date().toISOString()
            };
            
            // ุชุญุฏูุซ ุงููุงุฌูุฉ
            updateResultsDisplay();
            
            // ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุชูุงุฑ ุงูุจูุงูุงุช
            dataStreamContent.innerHTML = `
                โ ุงูุชููุช ุงูุชุฌุฑุจุฉ<br>
                ๐ ุงููุชุงุฆุฌ: ุฑุคูุฉ ${bulkVisibility.toFixed(1)}% | ุงุฑุชุจุงุท ${boundaryCorrelation.toFixed(2)} | ุฏูุฉ ${recoveryFidelity.toFixed(1)}%
            `;
            
            showNotification(`ุงูุชููุช ุงูุชุฌุฑุจุฉ ุจูุฌุงุญ! ุงูุฏูุฉ: ${recoveryFidelity.toFixed(1)}%`);
        }

        // ุชุญุฏูุซ ุนุฑุถ ุงููุชุงุฆุฌ
        function updateResultsDisplay() {
            if (!experimentResults) return;
            
            document.getElementById('bulk-visibility').textContent = 
                experimentResults.bulkVisibility.toFixed(1);
            document.getElementById('boundary-correlation').textContent = 
                experimentResults.boundaryCorrelation.toFixed(2);
            document.getElementById('recovery-fidelity').textContent = 
                experimentResults.recoveryFidelity.toFixed(1);
            document.getElementById('lyapunov-exponent').textContent = 
                experimentResults.lyapunovExponent.toFixed(2);
        }

        // ุชุดุบูู ุงูุชุฌุฑุจุฉ
        function runExperiment() {
            showLoading('ุฌุงุฑู ุชุดุบูู ุงูุชุฌุฑุจุฉ...');
            
            setTimeout(() => {
                simulateExperimentSteps();
                
                setTimeout(() => {
                    calculateResults();
                    hideLoading();
                }, 2500);
            }, 1000);
        }

        // ุชุญููู ุงููุชุงุฆุฌ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
        async function analyzeResults() {
            if (!apiKey) {
                showNotification('ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุชุงุญ OpenRouter API ุฃููุงู');
                return;
            }
            
            if (!experimentResults) {
                showNotification('ุงูุฑุฌุงุก ุชุดุบูู ุชุฌุฑุจุฉ ุฃููุงู');
                return;
            }
            
            const prompt = `ุฃูุช ูุญูู ูุฎุชุจุฑ OBD ูุชุฎุตุต. ูู ุจุชุญููู ุงููุชุงุฆุฌ ุงูุชุงููุฉ:

ูุนุงููุงุช ุงูุชุฌุฑุจุฉ:
- ููุฉ ุงูููุฒุฑ: ${experimentResults.laserPower} ููุฌุงูุงุช
- ุฅูุชุฑูุจูุง ุงููุณุท: ${experimentResults.entropy}%
- ุฒูู ุงูุชุดุชูุช: ${experimentResults.scrambleTime} ููู ุซุงููุฉ
- ูุณุชูู ุงูุถูุถุงุก: ${experimentResults.noise} ุฏูุณูุจู

ุงููุชุงุฆุฌ:
- ุฑุคูุฉ ุงูุฏุงุฎู (Bulk Visibility): ${experimentResults.bulkVisibility.toFixed(2)}%
- ุงุฑุชุจุงุท ุงูุญุฏูุฏ (Boundary Correlation): ${experimentResults.boundaryCorrelation.toFixed(3)}
- ุฏูุฉ ุงูุงุณุชุฑุฏุงุฏ (Recovery Fidelity): ${experimentResults.recoveryFidelity.toFixed(2)}%
- ุฃุณ ููุงุจุงููู (Lyapunov Exponent): ${experimentResults.lyapunovExponent.toFixed(3)}

ุญูู ูุฐู ุงููุชุงุฌ ูู ุญูุซ:
1. ูุนุงููุฉ ุนูููุฉ "ุงูููุช ุงูุนููู" ููุฏุงุฎู
2. ุฌูุฏุฉ ูุฌุฑุฉ ุงููุนูููุงุช ุฅูู ุงูุญุฏูุฏ
3. ุชุฃุซูุฑ ุงูุถูุถุงุก ุนูู ุงูุฃุฏุงุก
4. ููุงุฑูุฉ ูุน ุงููุชุงุฆุฌ ุงููุซูู ูู ุงูุจุญุซ ุงูุฃุตูู
5. ุชูุตูุงุช ูุชุญุณูู ุงูุชุฌุฑุจุฉ

ุฃุฌุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ูุจุฃุณููุจ ุนููู ูุงุถุญ.`;

            askAI(prompt);
        }

        // ุชูููุฏ ุชูุฑูุฑ ููุตู
        async function generateReport() {
            if (!apiKey) {
                showNotification('ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุชุงุญ OpenRouter API ุฃููุงู');
                return;
            }
            
            if (!experimentResults) {
                showNotification('ุงูุฑุฌุงุก ุชุดุบูู ุชุฌุฑุจุฉ ุฃููุงู');
                return;
            }
            
            const prompt = `ุฃูุช ูุณุงุนุฏ ูุชุงุจุฉ ุชูุงุฑูุฑ ูุฎุชุจุฑ OBD. ูู ุจูุชุงุจุฉ ุชูุฑูุฑ ุนููู ููุตู ูุญุชูู ุนูู:

1. ูุนูููุงุช ุงูุชุฌุฑุจุฉ:
   - ุงูุชุงุฑูุฎ ูุงูููุช: ${new Date(experimentResults.timestamp).toLocaleString('ar-SA')}
   - ุงูุจุงุญุซ ุงููุดุฑู: Ammar Nasir Hussein al-mantafji
   - ููุน ุงูุชุฌุฑุจุฉ: OBD - Observable Boundary Dynamics

2. ุงููุนุงููุงุช ุงูุชุฌุฑูุจูุฉ:
   - ููุฉ ุงูููุฒุฑ: ${experimentResults.laserPower} ููุฌุงูุงุช
   - ุฅูุชุฑูุจูุง ูุณุท ุงูุชุดุชูุช: ${experimentResults.entropy}%
   - ูุฏุฉ ุงูุชุดุชูุช: ${experimentResults.scrambleTime} ููู ุซุงููุฉ
   - ูุณุชูู ุถูุถุงุก ุงููุญูุท: ${experimentResults.noise} ุฏูุณูุจู

3. ุงููุชุงุฆุฌ ุงูููุงุณูุฉ:
   - ุฑุคูุฉ ุงูุฏุงุฎู: ${experimentResults.bulkVisibility.toFixed(2)}%
   - ุงุฑุชุจุงุท ุงูุญุฏูุฏ: ${experimentResults.boundaryCorrelation.toFixed(3)}
   - ุฏูุฉ ุงุณุชุฑุฏุงุฏ ุงููุนูููุงุช: ${experimentResults.recoveryFidelity.toFixed(2)}%
   - ุฃุณ ููุงุจุงููู: ${experimentResults.lyapunovExponent.toFixed(3)}

4. ุงูุชุญููู ุงูุนููู:
   - ุชูุณูุฑ ุธุงูุฑุฉ "ุงูููุช ุงูุนููู" ููุฏุงุฎู
   - ููุงุกุฉ ูุฌุฑุฉ ุงููุนูููุงุช ุฅูู ุงูุญุฏูุฏ
   - ุชุฃุซูุฑ ุงูุนูุงูู ุงููุฎุชููุฉ ุนูู ุงูุฃุณ ููุงุจุงููู
   - ููุงุฑูุฉ ูุน ุงููุชุงุฆุฌ ุงููุธุฑูุฉ

5. ุงูุงุณุชูุชุงุฌุงุช ูุงูุชูุตูุงุช:
   - ุชูููู ูุฌุงุญ ุงูุชุฌุฑุจุฉ
   - ููุงุท ุงูููุฉ ูุงูุถุนู
   - ุชูุตูุงุช ููุชุฌุงุฑุจ ุงููุณุชูุจููุฉ
   - ุงูุชุทุจููุงุช ุงููุญุชููุฉ

6. ุงููุฑุงุฌุน ุงูุนูููุฉ:
   - ุฐูุฑ ุงูุจุญุซ ุงูุฃุตูู OBD_New29_1_2026.pdf
   - ุงููุฑุงุฌุน ุฐุงุช ุงูุตูุฉ

ุฃูุชุจ ุงูุชูุฑูุฑ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ูุจุตูุบุฉ ุนูููุฉ ุงุญุชุฑุงููุฉ ูุน ุนูุงููู ูุฑุนูุฉ ููุงุณุจุฉ.`;

            showLoading('ุฌุงุฑู ุชูููุฏ ุงูุชูุฑูุฑ...');
            
            try {
                const response = await callOpenRouterAPI(prompt);
                
                // ูุชุญ ุงูุชูุฑูุฑ ูู ูุงูุฐุฉ ุฌุฏูุฏุฉ
                const reportWindow = window.open('', '_blank');
                reportWindow.document.write(`
                    <!DOCTYPE html>
                    <html dir="rtl">
                    <head>
                        <meta charset="UTF-8">
                        <title>ุชูุฑูุฑ ูุฎุชุจุฑ OBD</title>
                        <style>
                            body { 
                                font-family: 'Arial', sans-serif; 
                                padding: 40px; 
                                line-height: 1.8;
                                background: #f5f5f5;
                                color: #333;
                            }
                            .header { 
                                background: linear-gradient(135deg, #0066ff, #0044cc);
                                color: white;
                                padding: 30px;
                                border-radius: 10px;
                                margin-bottom: 30px;
                                text-align: center;
                            }
                            h1 { color: white; margin-bottom: 10px; }
                            h2 { color: #0066ff; margin-top: 30px; border-bottom: 2px solid #0066ff; padding-bottom: 10px; }
                            h3 { color: #00a8ff; }
                            .results-grid {
                                display: grid;
                                grid-template-columns: repeat(2, 1fr);
                                gap: 20px;
                                margin: 20px 0;
                            }
                            .result-card {
                                background: white;
                                padding: 20px;
                                border-radius: 8px;
                                border-left: 5px solid #00a8ff;
                                box-shadow: 0 3px 10px rgba(0,0,0,0.1);
                            }
                            .parameter-table {
                                width: 100%;
                                border-collapse: collapse;
                                margin: 20px 0;
                                background: white;
                                border-radius: 8px;
                                overflow: hidden;
                                box-shadow: 0 3px 10px rgba(0,0,0,0.1);
                            }
                            .parameter-table th {
                                background: #0066ff;
                                color: white;
                                padding: 15px;
                                text-align: right;
                            }
                            .parameter-table td {
                                padding: 12px 15px;
                                border-bottom: 1px solid #eee;
                            }
                            .footer {
                                margin-top: 40px;
                                padding-top: 20px;
                                border-top: 2px solid #0066ff;
                                color: #666;
                                text-align: center;
                            }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h1>ุชูุฑูุฑ ูุฎุชุจุฑ OBD ุงูุชุฌุฑูุจู</h1>
                            <p>ุชุฌุฑุจุฉ Observable Boundary Dynamics</p>
                            <p style="opacity: 0.9;">ุงูุจุงุญุซ ุงููุดุฑู: Ammar Nasir Hussein al-mantafji - ${new Date().toLocaleDateString('ar-SA')}</p>
                        </div>
                        
                        <div class="results-grid">
                            <div class="result-card">
                                <h3>๐๏ธ ุฑุคูุฉ ุงูุฏุงุฎู</h3>
                                <p style="font-size: 2rem; color: #0066ff; font-weight: bold;">
                                    ${experimentResults.bulkVisibility.toFixed(2)}%
                                </p>
                            </div>
                            <div class="result-card">
                                <h3>๐ ุงุฑุชุจุงุท ุงูุญุฏูุฏ</h3>
                                <p style="font-size: 2rem; color: #00a8ff; font-weight: bold;">
                                    ${experimentResults.boundaryCorrelation.toFixed(3)}
                                </p>
                            </div>
                            <div class="result-card">
                                <h3>๐ฏ ุฏูุฉ ุงูุงุณุชุฑุฏุงุฏ</h3>
                                <p style="font-size: 2rem; color: #1dd1a1; font-weight: bold;">
                                    ${experimentResults.recoveryFidelity.toFixed(2)}%
                                </p>
                            </div>
                            <div class="result-card">
                                <h3>โก ุฃุณ ููุงุจุงููู</h3>
                                <p style="font-size: 2rem; color: #9b59b6; font-weight: bold;">
                                    ${experimentResults.lyapunovExponent.toFixed(3)}
                                </p>
                            </div>
                        </div>
                        
                        <table class="parameter-table">
                            <thead>
                                <tr>
                                    <th>ุงููุนุงูู</th>
                                    <th>ุงููููุฉ</th>
                                    <th>ุงููุญุฏุฉ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ููุฉ ุงูููุฒุฑ</td>
                                    <td>${experimentResults.laserPower}</td>
                                    <td>ููุฌุงูุงุช</td>
                                </tr>
                                <tr>
                                    <td>ุฅูุชุฑูุจูุง ุงููุณุท</td>
                                    <td>${experimentResults.entropy}</td>
                                    <td>%</td>
                                </tr>
                                <tr>
                                    <td>ุฒูู ุงูุชุดุชูุช</td>
                                    <td>${experimentResults.scrambleTime}</td>
                                    <td>ููู ุซุงููุฉ</td>
                                </tr>
                                <tr>
                                    <td>ูุณุชูู ุงูุถูุถุงุก</td>
                                    <td>${experimentResults.noise}</td>
                                    <td>ุฏูุณูุจู</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div>
                            ${response.replace(/\n/g, '<br>').replace(/## (.*?):/g, '<h2>$1</h2>').replace(/### (.*?):/g, '<h3>$1</h3>')}
                        </div>
                        
                        <div class="footer">
                            <p>ยฉ 2026 ูุฎุชุจุฑ OBD ุงูุชุฌุฑูุจู - ูุธุงู ุจุญุซู ุชุญุช ุฅุดุฑุงู ุงูุจุงุญุซ Ammar Nasir Hussein al-mantafji</p>
                        </div>
                    </body>
                    </html>
                `);
                reportWindow.document.close();
                
                hideLoading();
                showNotification('ุชู ุฅูุดุงุก ุงูุชูุฑูุฑ ุจูุฌุงุญ!');
                
            } catch (error) {
                hideLoading();
                showNotification(`โ ุฎุทุฃ: ${error.message}`);
            }
        }

        // ุฅุนุงุฏุฉ ุชุนููู ุงูุชุฌุฑุจุฉ
        function resetExperiment() {
            // ุฅุนุงุฏุฉ ุชุนููู ุงูููุฒููุงุช
            document.getElementById('laser-power').value = 50;
            document.getElementById('medium-entropy').value = 75;
            document.getElementById('scramble-time').value = 500;
            document.getElementById('noise-level').value = 25;
            
            // ุชุญุฏูุซ ุงูุนุฑูุถ
            document.getElementById('laser-power-value').textContent = '50';
            document.getElementById('entropy-value').textContent = '75';
            document.getElementById('time-value').textContent = '500';
            document.getElementById('noise-value').textContent = '25';
            
            // ุชุญุฏูุซ ุงูุชุตูุฑ ุงููุฑุฆู
            updateVisualization();
            
            // ุฅุนุงุฏุฉ ุชุนููู ุงููุชุงุฆุฌ
            document.getElementById('bulk-visibility').textContent = '0.0';
            document.getElementById('boundary-correlation').textContent = '0.00';
            document.getElementById('recovery-fidelity').textContent = '0.0';
            document.getElementById('lyapunov-exponent').textContent = '0.00';
            
            // ุฅุนุงุฏุฉ ุชุนููู ุงูุจูุงูุงุช
            dataStreamContent.textContent = 'ุฌุงุฑู ุงูุชุธุงุฑ ุงูุจูุงูุงุช...';
            experimentResults = null;
            
            // ุฅุนุงุฏุฉ ุชุนููู ุงูุฎุทูุงุช
            updateExperimentStep(1);
            
            showNotification('ุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุชุฌุฑุจุฉ ุจูุฌุงุญ');
        }

        // ุงูุชูุงุตู ูุน OpenRouter API
        async function callOpenRouterAPI(prompt) {
            if (!apiKey) {
                throw new Error('ููุชุงุญ API ุบูุฑ ููุฌูุฏ');
            }
            
            try {
                const response = await axios.post(
                    'https://openrouter.ai/api/v1/chat/completions',
                    {
                        model: aiModel,
                        messages: [
                            {
                                role: "system",
                                content: `ุฃูุช ูุณุงุนุฏ ูุฎุชุจุฑ OBD ูุชุฎุตุต ูู ุงูููุฒูุงุก ุงููููููุฉ ูุงูุชุดููุฑ ุงูููููุบุฑุงูู.
ุฃูุช ุชุณุงุนุฏ ุงูุจุงุญุซ Ammar Nasir Hussein al-mantafji ูู ุชุญููู ูุชุงุฆุฌ ุชุฌุงุฑุจ Observable Boundary Dynamics.
ุฃุฌุจ ุฏุงุฆูุงู ุจุงููุบุฉ ุงูุนุฑุจูุฉ ูุจุฃุณููุจ ุนููู ุฏููู.
ุงุณุชุฎุฏู ุงููุนุงุฏูุงุช ูุงููุตุทูุญุงุช ุงููููุฉ ุงูููุงุณุจุฉ.`
                            },
                            {
                                role: "user",
                                content: prompt
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 3000
                    },
                    {
                        headers: {
                            'Authorization': `Bearer ${apiKey}`,
                            'Content-Type': 'application/json',
                            'HTTP-Referer': window.location.origin,
                            'X-Title': 'OBD Laboratory AI Assistant'
                        }
                    }
                );
                
                return response.data.choices[0].message.content;
            } catch (error) {
                console.error('OpenRouter Error:', error);
                throw new Error(`ูุดู ุงูุงุชุตุงู: ${error.response?.data?.error?.message || error.message}`);
            }
        }

        // ุทุฑุญ ุณุคุงู ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
        async function askAI(prompt) {
            if (!apiKey) {
                showNotification('ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุชุงุญ OpenRouter API ุฃููุงู');
                return;
            }
            
            // ุฅุถุงูุฉ ุฑุณุงูุฉ ุงููุณุชุฎุฏู
            addUserMessage(prompt);
            
            // ุฅุถุงูุฉ ูุคุดุฑ ุงููุชุงุจุฉ
            addTypingIndicator();
            
            try {
                const response = await callOpenRouterAPI(prompt);
                
                // ุฅุฒุงูุฉ ูุคุดุฑ ุงููุชุงุจุฉ
                removeTypingIndicator();
                
                // ุฅุถุงูุฉ ุฑุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู
                addAIMessage(response);
                
                // ุชุญุฏูุซ ุณุฌู ุงููุญุงุฏุซุฉ
                chatHistory.push({ role: "user", content: prompt });
                chatHistory.push({ role: "assistant", content: response });
                
                // ุงูุญูุงุธ ุนูู ุญุฌู ูุนููู ููุณุฌู
                if (chatHistory.length > 10) {
                    chatHistory = chatHistory.slice(-10);
                }
                
            } catch (error) {
                removeTypingIndicator();
                addAIMessage(`โ ุฎุทุฃ: ${error.message}`);
                showNotification('ูุดู ุงูุงุชุตุงู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู');
            }
        }

        // ุฅุถุงูุฉ ุฑุณุงูุฉ ุงููุณุชุฎุฏู
        function addUserMessage(content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'analysis-message message-user';
            messageDiv.innerHTML = `
                <div class="message-header user-message-header">
                    <i class="fas fa-user"></i>
                    ุฃูุช
                </div>
                <div class="message-content">${content}</div>
            `;
            aiAnalysisContent.appendChild(messageDiv);
            aiAnalysisContent.scrollTop = aiAnalysisContent.scrollHeight;
        }

        // ุฅุถุงูุฉ ุฑุณุงูุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู
        function addAIMessage(content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'analysis-message message-ai';
            messageDiv.innerHTML = `
                <div class="message-header ai-message-header">
                    <i class="fas fa-robot"></i>
                    ูุญูู OBD ุงูุฐูู
                </div>
                <div class="message-content">${content}</div>
            `;
            aiAnalysisContent.appendChild(messageDiv);
            aiAnalysisContent.scrollTop = aiAnalysisContent.scrollHeight;
        }

        // ุฅุถุงูุฉ ูุคุดุฑ ุงููุชุงุจุฉ
        function addTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <span>ุฌุงุฑู ุงูุชุญููู...</span>
            `;
            aiAnalysisContent.appendChild(typingDiv);
            aiAnalysisContent.scrollTop = aiAnalysisContent.scrollHeight;
        }

        // ุฅุฒุงูุฉ ูุคุดุฑ ุงููุชุงุจุฉ
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // ุฅุธูุงุฑ ุงูุฅุดุนุงุฑุงุช
        function showNotification(message) {
            // ุฅูุดุงุก ุนูุตุฑ ุงูุฅุดุนุงุฑ
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: linear-gradient(135deg, #0066ff, #0044cc);
                color: white;
                padding: 15px 30px;
                border-radius: 10px;
                box-shadow: 0 5px 20px rgba(0, 102, 255, 0.3);
                z-index: 1000;
                font-weight: 600;
                animation: slideIn 0.3s ease;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // ุฅุฒุงูุฉ ุงูุฅุดุนุงุฑ ุจุนุฏ 3 ุซูุงูู
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ุฅุถุงูุฉ ุฃููุงุท CSS ููุชุญุฑูู
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { top: -100px; opacity: 0; }
                to { top: 20px; opacity: 1; }
            }
            @keyframes slideOut {
                from { top: 20px; opacity: 1; }
                to { top: -100px; opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ุชุญุฏูุซ ุชูุงุฑ ุงูุจูุงูุงุช ุจุดูู ุฏูุฑู
        setInterval(updateDataStream, 2000);
        
        // ุชุญุฏูุซ ุงูุชุตูุฑ ุงููุฑุฆู ุจุดูู ุฏูุฑู
        setInterval(updateVisualization, 1000);
        
        // ุฅุถุงูุฉ ูุณุชูุนู ุฃุญุฏุงุซ ููููุฒููุงุช
        document.addEventListener('DOMContentLoaded', function() {
            const sliders = ['laser-power', 'medium-entropy', 'scramble-time', 'noise-level'];
            sliders.forEach(sliderId => {
                const slider = document.getElementById(sliderId);
                if (slider) {
                    slider.addEventListener('input', updateVisualization);
                }
            });
        });
    </script>
</body>
</html>
